# GPSTrackingService - Implementation Prompt

**Phase**: P3 (Week 19) | **Effort**: 1 semana | **Deps**: BlockchainService, bazari-attestation

## ðŸ“‹ Contexto

**Problema**: GPS tracking on-chain custaria $0.60-12/entrega

**SoluÃ§Ã£o**: GPS off-chain (PostgreSQL) + proofs on-chain (bazari-attestation)

## ðŸŽ¯ Objetivo

Criar `/root/bazari/apps/api/src/services/gps-tracking.service.ts` com:
- GPS waypoints off-chain (lat/long/timestamp)
- Final proof on-chain (HandoffProof, DeliveryProof)

## âœ… Checklist

```typescript
@Injectable()
export class GPSTrackingService {
  async recordWaypoint(data: WaypointDto) {
    return this.prisma.deliveryWaypoint.create({
      data: {
        orderId: data.orderId,
        lat: data.lat,
        lng: data.lng,
        timestamp: new Date(),
      },
    });
  }
  
  async submitHandoffProof(orderId: string) {
    const waypoints = await this.getWaypoints(orderId);
    const ipfsCid = await this.uploadToIPFS(waypoints);
    
    await this.blockchainService.submitProof(
      orderId,
      ProofType.HandoffProof,
      ipfsCid,
      [seller, courier],
      2, // 2-of-2
    );
  }
}
```

## ðŸ¤– Prompt

```
Criar GPSTrackingService NestJS.

CHECKLIST:
âœ… /root/bazari/apps/api/src/services/gps-tracking.service.ts
âœ… Record waypoints (lat/lng/timestamp) â†’ PostgreSQL
âœ… Submit HandoffProof (upload to IPFS, call blockchain)
âœ… Submit DeliveryProof (co-sign flow)
âœ… Tests
```

**Generated by**: Claude Code | **Version**: 1.0.0
