// path: apps/api/prisma/schema.prisma
generator client {
  provider = "prisma-client-js" 
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model MediaAsset {
  id          String   @id @default(cuid())
  url         String   // FS: /uploads/abc.png; S3: URL p√∫blica
  mime        String
  size        Int
  contentHash String
  ownerType   String?
  ownerId     String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([ownerType, ownerId])
  @@index([contentHash])
}

model Category {
  id        String   @id @default(cuid())
  slug      String   @unique
  level     Int
  pathSlugs String[] @db.Text
  namePt    String
  nameEn    String
  nameEs    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([slug])
  @@index([level])
  @@index([pathSlugs])
}

model AuditLog {
  id        String   @id @default(cuid())
  entity    String
  entityId  String
  actor     String?
  action    String
  diff      Json?
  ip        String?
  ua        String?
  createdAt DateTime @default(now())

  @@index([entity, entityId])
  @@index([actor])
  @@index([createdAt])
}